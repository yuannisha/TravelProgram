{"version":3,"file":"plan-detail.js","sources":["pages/plans/plan-detail.vue","E:/HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcGxhbnMvcGxhbi1kZXRhaWwudnVl"],"sourcesContent":["<template>\n\t<view class=\"container\">\n\t\t<view v-if=\"loading\" class=\"loading\">\n\t\t\t<uni-load-more status=\"loading\"></uni-load-more>\n\t\t</view>\n\t\t\n\t\t<block v-else>\n\t\t\t<view class=\"plan-header\">\n\t\t\t\t<view class=\"title-section\">\n\t\t\t\t\t<view class=\"title\">{{ planData.title }}</view>\n\t\t\t\t\t<view class=\"status\" :class=\"'status-' + planData.status\">\n\t\t\t\t\t\t{{ getStatusText(planData.status) }}\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<!-- 用户信息（仅在查看模式下显示） -->\n\t\t\t\t<view class=\"user-info\" v-if=\"viewMode && planData.user_info\">\n\t\t\t\t\t<image \n\t\t\t\t\t\t:src=\"planData.user_info.avatar || '/static/default-avatar.png'\" \n\t\t\t\t\t\tmode=\"aspectFill\" \n\t\t\t\t\t\tclass=\"avatar\"\n\t\t\t\t\t></image>\n\t\t\t\t\t<text class=\"username\">{{ planData.user_info.nickname || planData.user_info.username || '用户' }}</text>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<view class=\"date-section\">\n\t\t\t\t\t<uni-icons type=\"calendar\" size=\"18\" color=\"#666\"></uni-icons>\n\t\t\t\t\t<text>{{ formatDate(planData.start_date) }} - {{ formatDate(planData.end_date) }}</text>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<view class=\"desc-section\" v-if=\"planData.description\">\n\t\t\t\t\t<text>{{ planData.description }}</text>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<view class=\"action-section\" v-if=\"!viewMode\">\n\t\t\t\t\t<view class=\"action-btn edit\" @click=\"navigateToEdit\">\n\t\t\t\t\t\t<uni-icons type=\"compose\" size=\"16\" color=\"#007AFF\"></uni-icons>\n\t\t\t\t\t\t<text>编辑</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"action-btn share\" @click=\"sharePlan\">\n\t\t\t\t\t\t<uni-icons type=\"redo\" size=\"16\" color=\"#4CD964\"></uni-icons>\n\t\t\t\t\t\t<text>分享</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"action-btn delete\" @click=\"confirmDelete\">\n\t\t\t\t\t\t<uni-icons type=\"trash\" size=\"16\" color=\"#FF3B30\"></uni-icons>\n\t\t\t\t\t\t<text>删除</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<!-- 收藏按钮（仅在查看模式下显示） -->\n\t\t\t\t<view class=\"action-section\" v-if=\"viewMode\">\n\t\t\t\t\t<view class=\"action-btn like\" @click=\"toggleFavorite\">\n\t\t\t\t\t\t<uni-icons :type=\"isFavorite ? 'heart-filled' : 'heart'\" size=\"16\" :color=\"isFavorite ? '#FF5A5F' : '#999'\"></uni-icons>\n\t\t\t\t\t\t<text>{{ isFavorite ? '已收藏' : '收藏' }}</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"action-btn share\" @click=\"sharePlan\">\n\t\t\t\t\t\t<uni-icons type=\"redo\" size=\"16\" color=\"#4CD964\"></uni-icons>\n\t\t\t\t\t\t<text>分享</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<view class=\"spots-section\">\n\t\t\t\t<view class=\"section-title\">景点列表</view>\n\t\t\t\t\n\t\t\t\t<view v-if=\"planData.spots && planData.spots.length > 0\" class=\"spots-list\">\n\t\t\t\t\t<view \n\t\t\t\t\t\tv-for=\"(dateGroup, dateIndex) in groupedSpots\" \n\t\t\t\t\t\t:key=\"dateIndex\" \n\t\t\t\t\t\tclass=\"date-group\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<view class=\"date-header\">\n\t\t\t\t\t\t\t<text class=\"day-number\">第{{ dateGroup.dayNumber }}天</text>\n\t\t\t\t\t\t\t<text class=\"date-text\">{{ formatDate(dateGroup.date) }}</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<view \n\t\t\t\t\t\t\tv-for=\"(spot, spotIndex) in dateGroup.spots\" \n\t\t\t\t\t\t\t:key=\"spotIndex\" \n\t\t\t\t\t\t\tclass=\"spot-item\"\n\t\t\t\t\t\t\t@click=\"navigateToSpotDetail(spot.spot_id)\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<view class=\"spot-content\">\n\t\t\t\t\t\t\t\t<image \n\t\t\t\t\t\t\t\t\tv-if=\"spot.spot_detail && spot.spot_detail.imageUrl\" \n\t\t\t\t\t\t\t\t\t:src=\"spot.spot_detail.imageUrl\" \n\t\t\t\t\t\t\t\t\tmode=\"aspectFill\" \n\t\t\t\t\t\t\t\t\tclass=\"spot-image\"\n\t\t\t\t\t\t\t\t></image>\n\t\t\t\t\t\t\t\t<image \n\t\t\t\t\t\t\t\t\tv-else \n\t\t\t\t\t\t\t\t\tsrc=\"/static/spots/default.jpg\" \n\t\t\t\t\t\t\t\t\tmode=\"aspectFill\" \n\t\t\t\t\t\t\t\t\tclass=\"spot-image\"\n\t\t\t\t\t\t\t\t></image>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<view class=\"spot-info\">\n\t\t\t\t\t\t\t\t\t<view class=\"spot-name\">{{ spot.spot_detail ? spot.spot_detail.name : '未知景点' }}</view>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<view class=\"spot-address\" v-if=\"spot.spot_detail && spot.spot_detail.address\">\n\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"location\" size=\"14\" color=\"#666\"></uni-icons>\n\t\t\t\t\t\t\t\t\t\t<text>{{ spot.spot_detail.address }}</text>\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<view class=\"spot-price\" v-if=\"spot.spot_detail && spot.spot_detail.price !== undefined\">\n\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"rmb\" size=\"14\" color=\"#666\"></uni-icons>\n\t\t\t\t\t\t\t\t\t\t<text>{{ formatPrice(spot.spot_detail.price) }}</text>\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<view class=\"spot-notes\" v-if=\"spot.notes\">\n\t\t\t\t\t\t\t\t<text class=\"notes-label\">备注：</text>\n\t\t\t\t\t\t\t\t<text class=\"notes-content\">{{ spot.notes }}</text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<view v-else class=\"empty-spots\">\n\t\t\t\t\t<image src=\"/static/empty.png\" mode=\"aspectFit\" class=\"empty-image\"></image>\n\t\t\t\t\t<text>{{ viewMode ? '该用户计划中并无景点' : '暂无景点，请在编辑页面添加景点' }}</text>\n\t\t\t\t\t<button v-if=\"!viewMode\" class=\"add-btn\" @click=\"navigateToEdit\">添加景点</button>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</block>\n\t</view>\n</template>\n\n<script>\n\t/**\n\t * 旅行计划详情页面\n\t * @description 显示旅行计划的详细信息，包括景点列表\n\t */\n\texport default {\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tplanId: '',\n\t\t\t\tplanData: {},\n\t\t\t\tloading: true,\n\t\t\t\tviewMode: false,\n\t\t\t\tisFavorite: false\n\t\t\t}\n\t\t},\n\t\tonLoad(options) {\n\t\t\t// 页面加载时检查登录状态\n\t\t\tconst app = getApp();\n\t\t\tapp.globalData.checkLoginStatus(true); // 强制跳转，因为查看详情必须登录\n\t\t\tconsole.log(\"options\",options)\n\t\t\tif (options.id) {\n\t\t\t\tthis.planId = options.id;\n\t\t\t\t// 设置查看模式\n\t\t\t\tif (options.mode === 'view') {\n\t\t\t\t\tthis.viewMode = true;\n\t\t\t\t}\n\t\t\t\tthis.getPlanDetail();\n\t\t\t} else {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '参数错误',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t});\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tuni.navigateBack();\n\t\t\t\t}, 1500);\n\t\t\t}\n\t\t},\n\t\tmethods: {\n\t\t\t/**\n\t\t\t * 获取计划详情\n\t\t\t */\n\t\t\tasync getPlanDetail() {\n\t\t\t\tthis.loading = true;\n\t\t\t\t\n\t\t\t\ttry {\n\t\t\t\t\tconst app = getApp();\n\t\t\t\t\tconst userId = app.globalData.getUserId();\n\t\t\t\t\t\n\t\t\t\t\tconst res = await uniCloud.callFunction({\n\t\t\t\t\t\tname: 'manage-plans',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\taction: 'get',\n\t\t\t\t\t\t\tplan_id: this.planId,\n\t\t\t\t\t\t\tuser_id: userId\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tif (res.result.code === 0) {\n\t\t\t\t\t\tthis.planData = res.result.data;\n\t\t\t\t\t\t\n\t\t\t\t\t\t// 如果是查看模式，检查是否已收藏\n\t\t\t\t\t\tif (this.viewMode) {\n\t\t\t\t\t\t\tthis.checkFavorite();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: res.result.message || '获取计划详情失败',\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tuni.navigateBack();\n\t\t\t\t\t\t}, 1500);\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('获取计划详情失败', e);\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '获取计划详情失败，请稍后重试',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tuni.navigateBack();\n\t\t\t\t\t}, 1500);\n\t\t\t\t} finally {\n\t\t\t\t\tthis.loading = false;\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * 检查是否已收藏\n\t\t\t */\n\t\t\tasync checkFavorite() {\n\t\t\t\t// 检查登录状态\n\t\t\t\tconst userInfo = uni.getStorageSync('userInfo');\n\t\t\t\tif (!userInfo) return;\n\t\t\t\t\n\t\t\t\ttry {\n\t\t\t\t\tconst res = await uniCloud.callFunction({\n\t\t\t\t\t\tname: 'get-favorite-status',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tuid: userInfo.id,\n\t\t\t\t\t\t\ttype: 'plan',\n\t\t\t\t\t\t\tplanId: this.planId\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tif (res.result.code === 0) {\n\t\t\t\t\t\tthis.isFavorite = res.result.data.isFavorite;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('检查收藏状态失败', e);\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * 切换收藏状态\n\t\t\t */\n\t\t\tasync toggleFavorite() {\n\t\t\t\t// 检查登录状态\n\t\t\t\tconst userInfo = uni.getStorageSync('userInfo');\n\t\t\t\tif (!userInfo) {\n\t\t\t\t\tuni.navigateTo({\n\t\t\t\t\t\turl: '/pages/user/login'\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\ttry {\n\t\t\t\t\t// 显示加载中\n\t\t\t\t\tuni.showLoading({\n\t\t\t\t\t\ttitle: '处理中...'\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tconst res = await uniCloud.callFunction({\n\t\t\t\t\t\tname: 'toggle-favorite',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tuid: userInfo.id,\n\t\t\t\t\t\t\ttype: 'plan',\n\t\t\t\t\t\t\tplanId: this.planId\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tif (res.result.code === 0) {\n\t\t\t\t\t\tthis.isFavorite = res.result.data.isFavorite;\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: this.isFavorite ? '收藏成功' : '已取消收藏',\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: res.result.message || '操作失败',\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('收藏操作失败', e);\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '操作失败，请稍后重试',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t} finally {\n\t\t\t\t\tuni.hideLoading();\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * 跳转到编辑页面\n\t\t\t */\n\t\t\tnavigateToEdit() {\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl: `/pages/plans/plan-edit?id=${this.planId}`\n\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * 分享计划\n\t\t\t */\n\t\t\tsharePlan() {\n\t\t\t\t// 如果计划不是公开的，提示用户设为公开\n\t\t\t\tif (!this.planData.is_public) {\n\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\ttitle: '分享提示',\n\t\t\t\t\t\tcontent: '当前计划为私有状态，需要设为公开才能分享给他人查看，是否设为公开？',\n\t\t\t\t\t\tconfirmText: '设为公开',\n\t\t\t\t\t\tsuccess: async (res) => {\n\t\t\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\t\t\tawait this.setPublic(true);\n\t\t\t\t\t\t\t\tif (this.planData.is_public) {\n\t\t\t\t\t\t\t\t\tthis.showShareOptions();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.showShareOptions();\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * 显示分享选项\n\t\t\t */\n\t\t\tshowShareOptions() {\n\t\t\t\tuni.showActionSheet({\n\t\t\t\t\titemList: ['分享到微信', '复制链接'],\n\t\t\t\t\tsuccess: res => {\n\t\t\t\t\t\tif (res.tapIndex === 0) {\n\t\t\t\t\t\t\t// 分享到微信\n\t\t\t\t\t\t\tuni.share({\n\t\t\t\t\t\t\t\tprovider: 'weixin',\n\t\t\t\t\t\t\t\tscene: 'WXSceneSession',\n\t\t\t\t\t\t\t\ttype: 0,\n\t\t\t\t\t\t\t\ttitle: this.planData.title,\n\t\t\t\t\t\t\t\tsummary: this.planData.description || '快来看看我的旅行计划吧',\n\t\t\t\t\t\t\t\timageUrl: this.planData.spots?.[0]?.spot_detail?.imageUrl || '/static/logo.png',\n\t\t\t\t\t\t\t\thref: `https://example.com/pages/plans/plan-detail?id=${this.planId}&mode=view`,\n\t\t\t\t\t\t\t\tsuccess: function (res) {\n\t\t\t\t\t\t\t\t\tconsole.log('分享成功', res);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tfail: function (err) {\n\t\t\t\t\t\t\t\t\tconsole.log('分享失败', err);\n\t\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\t\ttitle: '分享失败',\n\t\t\t\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// 复制链接\n\t\t\t\t\t\t\tconst path = `/pages/plans/plan-detail?id=${this.planId}&mode=view`;\n\t\t\t\t\t\t\tuni.setClipboardData({\n\t\t\t\t\t\t\t\tdata: `https://example.com${path}`,\n\t\t\t\t\t\t\t\tsuccess: () => {\n\t\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\t\ttitle: '链接已复制',\n\t\t\t\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * 设置计划公开状态\n\t\t\t * @param {Boolean} isPublic 是否公开\n\t\t\t */\n\t\t\tasync setPublic(isPublic) {\n\t\t\t\tuni.showLoading({\n\t\t\t\t\ttitle: '设置中...'\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\ttry {\n\t\t\t\t\tconst app = getApp();\n\t\t\t\t\tconst userId = app.globalData.getUserId();\n\t\t\t\t\t\n\t\t\t\t\tconst res = await uniCloud.callFunction({\n\t\t\t\t\t\tname: 'manage-plans',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\taction: 'update',\n\t\t\t\t\t\t\tplan_id: this.planId,\n\t\t\t\t\t\t\tplan: {\n\t\t\t\t\t\t\t\tis_public: isPublic\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tuser_id: userId\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tif (res.result.code === 0) {\n\t\t\t\t\t\tthis.planData.is_public = isPublic;\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: isPublic ? '已设为公开' : '已设为私有'\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: res.result.message || '设置失败',\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('设置公开状态失败', e);\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '设置失败，请稍后重试',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t} finally {\n\t\t\t\t\tuni.hideLoading();\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * 确认删除计划\n\t\t\t */\n\t\t\tconfirmDelete() {\n\t\t\t\tuni.showModal({\n\t\t\t\t\ttitle: '确认删除',\n\t\t\t\t\tcontent: '确定要删除这个旅行计划吗？',\n\t\t\t\t\tconfirmColor: '#FF3B30',\n\t\t\t\t\tsuccess: async (res) => {\n\t\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\t\tthis.deletePlan();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * 删除计划\n\t\t\t */\n\t\t\tasync deletePlan() {\n\t\t\t\tuni.showLoading({\n\t\t\t\t\ttitle: '删除中...'\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\ttry {\n\t\t\t\t\tconst app = getApp();\n\t\t\t\t\tconst userId = app.globalData.getUserId();\n\t\t\t\t\t\n\t\t\t\t\tconst res = await uniCloud.callFunction({\n\t\t\t\t\t\tname: 'manage-plans',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\taction: 'delete',\n\t\t\t\t\t\t\tplan_id: this.planId,\n\t\t\t\t\t\t\tuser_id: userId\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tif (res.result.code === 0) {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: '删除成功'\n\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t\t// 返回上一页并刷新列表\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tconst pages = getCurrentPages();\n\t\t\t\t\t\t\tconst prevPage = pages[pages.length - 2];\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// 如果上一页是计划列表页，刷新列表\n\t\t\t\t\t\t\tif (prevPage && prevPage.route === 'pages/plans/plans') {\n\t\t\t\t\t\t\t\tprevPage.$vm.getPlans(true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tuni.navigateBack();\n\t\t\t\t\t\t}, 1500);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: res.result.message || '删除失败',\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('删除计划失败', e);\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '删除失败，请稍后重试',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t} finally {\n\t\t\t\t\tuni.hideLoading();\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * 跳转到景点详情页面\n\t\t\t * @param {String} spotId 景点ID\n\t\t\t */\n\t\t\tnavigateToSpotDetail(spotId) {\n\t\t\t\tif (!spotId || spotId.startsWith('mock_spot_id_')) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '模拟景点，无法查看详情',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl: `/pages/spots/detail?id=${spotId}`\n\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * 获取状态文本\n\t\t\t * @param {Number} status 状态值\n\t\t\t * @return {String} 状态文本\n\t\t\t */\n\t\t\tgetStatusText(status) {\n\t\t\t\tconst statusMap = {\n\t\t\t\t\t0: '计划中',\n\t\t\t\t\t1: '进行中',\n\t\t\t\t\t2: '已完成'\n\t\t\t\t};\n\t\t\t\treturn statusMap[status] || '未知';\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * 格式化日期\n\t\t\t * @param {Number|String} timestamp 时间戳\n\t\t\t * @return {String} 格式化后的日期\n\t\t\t */\n\t\t\tformatDate(timestamp) {\n\t\t\t\tif (!timestamp) return '';\n\t\t\t\tconst date = new Date(timestamp);\n\t\t\t\treturn `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * 格式化价格\n\t\t\t * @param {Number} price 价格（单位：分）\n\t\t\t * @return {String} 格式化后的价格\n\t\t\t */\n\t\t\tformatPrice(price) {\n\t\t\t\tif (price === undefined || price === null) return '';\n\t\t\t\treturn '¥' + (price / 100).toFixed(2);\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * 获取景点的游览天数\n\t\t\t * @param {Object} spot 景点对象\n\t\t\t * @return {Number} 游览天数（从计划开始日期算起的第几天）\n\t\t\t */\n\t\t\tgetVisitDay(spot) {\n\t\t\t\tif (!spot || !spot.visit_date || !this.planData.start_date) return 1;\n\t\t\t\t\n\t\t\t\t// 获取日期字符串，不考虑时间部分\n\t\t\t\tconst visitDateStr = this.formatDate(spot.visit_date);\n\t\t\t\tconst startDateStr = this.formatDate(this.planData.start_date);\n\t\t\t\t\n\t\t\t\t// 如果日期字符串相同，说明是第一天\n\t\t\t\tif (visitDateStr === startDateStr) return 1;\n\t\t\t\t\n\t\t\t\t// 计算日期差值\n\t\t\t\tconst visitDate = new Date(visitDateStr);\n\t\t\t\tconst startDate = new Date(startDateStr);\n\t\t\t\tconst diffTime = visitDate.getTime() - startDate.getTime();\n\t\t\t\tconst diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n\t\t\t\t\n\t\t\t\treturn diffDays + 1; // 加1是因为从第一天开始计数\n\t\t\t}\n\t\t},\n\t\tcomputed: {\n\t\t\t/**\n\t\t\t * 按日期分组后的景点列表\n\t\t\t */\n\t\t\tgroupedSpots() {\n\t\t\t\tif (!this.planData.spots || !this.planData.spots.length) {\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// 创建一个按游览日期分组的对象\n\t\t\t\tconst groupsByDate = {};\n\t\t\t\t\n\t\t\t\t// 按日期对景点进行分组\n\t\t\t\tthis.planData.spots.forEach(spot => {\n\t\t\t\t\tconst dateKey = this.formatDate(spot.visit_date);\n\t\t\t\t\tif (!groupsByDate[dateKey]) {\n\t\t\t\t\t\tconst dayNumber = this.getVisitDay(spot);\n\t\t\t\t\t\tgroupsByDate[dateKey] = {\n\t\t\t\t\t\t\tdate: spot.visit_date,\n\t\t\t\t\t\t\tdayNumber: dayNumber,\n\t\t\t\t\t\t\tspots: []\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tgroupsByDate[dateKey].spots.push(spot);\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t// 将分组对象转换为数组并按日期排序\n\t\t\t\treturn Object.values(groupsByDate).sort((a, b) => a.date - b.date);\n\t\t\t}\n\t\t},\n\t\t// 监听页面返回\n\t\tonShow() {\n\t\t\t// 如果不是第一次加载（即从编辑页面返回），则刷新数据\n\t\t\tif (!this.loading && this.planId) {\n\t\t\t\tthis.getPlanDetail();\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style lang=\"scss\">\n\t.container {\n\t\tbackground-color: #f5f5f5;\n\t\tmin-height: 100vh;\n\t\tpadding-bottom: 30rpx;\n\t}\n\t\n\t.loading {\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\theight: 300rpx;\n\t}\n\t\n\t.plan-header {\n\t\tbackground-color: #ffffff;\n\t\tpadding: 30rpx;\n\t\tmargin-bottom: 20rpx;\n\t\t\n\t\t.title-section {\n\t\t\tdisplay: flex;\n\t\t\tjustify-content: space-between;\n\t\t\talign-items: center;\n\t\t\tmargin-bottom: 20rpx;\n\t\t\t\n\t\t\t.title {\n\t\t\t\tfont-size: 36rpx;\n\t\t\t\tfont-weight: bold;\n\t\t\t\tcolor: #333333;\n\t\t\t\tflex: 1;\n\t\t\t}\n\t\t\t\n\t\t\t.status {\n\t\t\t\tpadding: 6rpx 20rpx;\n\t\t\t\tborder-radius: 20rpx;\n\t\t\t\tfont-size: 24rpx;\n\t\t\t\t\n\t\t\t\t&.status-0 {\n\t\t\t\t\tcolor: #007AFF;\n\t\t\t\t\tbackground-color: rgba(0, 122, 255, 0.1);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t&.status-1 {\n\t\t\t\t\tcolor: #FF9500;\n\t\t\t\t\tbackground-color: rgba(255, 149, 0, 0.1);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t&.status-2 {\n\t\t\t\t\tcolor: #4CD964;\n\t\t\t\t\tbackground-color: rgba(76, 217, 100, 0.1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t.user-info {\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tmargin-bottom: 20rpx;\n\t\t\tpadding: 10rpx 0;\n\t\t\tborder-bottom: 1rpx solid #f0f0f0;\n\t\t\t\n\t\t\t.avatar {\n\t\t\t\twidth: 60rpx;\n\t\t\t\theight: 60rpx;\n\t\t\t\tborder-radius: 50%;\n\t\t\t\tmargin-right: 16rpx;\n\t\t\t}\n\t\t\t\n\t\t\t.username {\n\t\t\t\tfont-size: 28rpx;\n\t\t\t\tcolor: #333333;\n\t\t\t}\n\t\t}\n\t\t\n\t\t.date-section {\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tmargin-bottom: 20rpx;\n\t\t\t\n\t\t\ttext {\n\t\t\t\tfont-size: 28rpx;\n\t\t\t\tcolor: #666666;\n\t\t\t\tmargin-left: 10rpx;\n\t\t\t}\n\t\t}\n\t\t\n\t\t.desc-section {\n\t\t\tmargin-bottom: 20rpx;\n\t\t\t\n\t\t\ttext {\n\t\t\t\tfont-size: 28rpx;\n\t\t\t\tcolor: #666666;\n\t\t\t\tline-height: 1.5;\n\t\t\t}\n\t\t}\n\t\t\n\t\t.action-section {\n\t\t\tdisplay: flex;\n\t\t\tjustify-content: flex-end;\n\t\t\tmargin-top: 30rpx;\n\t\t\tpadding-top: 20rpx;\n\t\t\tborder-top: 1rpx solid #f0f0f0;\n\t\t\t\n\t\t\t.action-btn {\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tmargin-left: 30rpx;\n\t\t\t\t\n\t\t\t\ttext {\n\t\t\t\t\tfont-size: 28rpx;\n\t\t\t\t\tmargin-left: 6rpx;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t&.edit {\n\t\t\t\t\tcolor: #007AFF;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t&.share {\n\t\t\t\t\tcolor: #4CD964;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t&.delete {\n\t\t\t\t\tcolor: #FF3B30;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t&.like {\n\t\t\t\t\tcolor: #999;\n\t\t\t\t\t\n\t\t\t\t\t&.active {\n\t\t\t\t\t\tcolor: #FF5A5F;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\t.spots-section {\n\t\tbackground-color: #ffffff;\n\t\tborder-radius: 20rpx;\n\t\tpadding: 30rpx;\n\t\t\n\t\t.section-title {\n\t\t\tfont-size: 32rpx;\n\t\t\tfont-weight: bold;\n\t\t\tcolor: #333333;\n\t\t\tmargin-bottom: 30rpx;\n\t\t}\n\t\t\n\t\t.spots-list {\n\t\t\t.date-group {\n\t\t\t\tmargin-bottom: 30rpx;\n\t\t\t\t\n\t\t\t\t.date-header {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tpadding: 10rpx 0;\n\t\t\t\t\tmargin-bottom: 20rpx;\n\t\t\t\t\tborder-bottom: 1rpx solid #f0f0f0;\n\t\t\t\t\t\n\t\t\t\t\t.day-number {\n\t\t\t\t\t\tpadding: 6rpx 16rpx;\n\t\t\t\t\t\tbackground-color: rgba(0, 122, 255, 0.8);\n\t\t\t\t\t\tcolor: #ffffff;\n\t\t\t\t\t\tfont-size: 24rpx;\n\t\t\t\t\t\tborder-radius: 6rpx;\n\t\t\t\t\t\tmargin-right: 16rpx;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t.date-text {\n\t\t\t\t\t\tfont-size: 26rpx;\n\t\t\t\t\t\tcolor: #666666;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\n\t\t\t\t.spot-item {\n\t\t\t\t\tmargin-bottom: 30rpx;\n\t\t\t\t\tpadding-bottom: 20rpx;\n\t\t\t\t\tborder-bottom: 1rpx dashed #f0f0f0;\n\t\t\t\t\t\n\t\t\t\t\t&:last-child {\n\t\t\t\t\t\tmargin-bottom: 0;\n\t\t\t\t\t\tpadding-bottom: 0;\n\t\t\t\t\t\tborder-bottom: none;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t.spot-content {\n\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\tmargin-bottom: 20rpx;\n\t\t\t\t\t\t\n\t\t\t\t\t\t.spot-image {\n\t\t\t\t\t\t\twidth: 200rpx;\n\t\t\t\t\t\t\theight: 150rpx;\n\t\t\t\t\t\t\tborder-radius: 10rpx;\n\t\t\t\t\t\t\tmargin-right: 20rpx;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t.spot-info {\n\t\t\t\t\t\t\tflex: 1;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t.spot-name {\n\t\t\t\t\t\t\t\tfont-size: 30rpx;\n\t\t\t\t\t\t\t\tfont-weight: bold;\n\t\t\t\t\t\t\t\tcolor: #333333;\n\t\t\t\t\t\t\t\tmargin-bottom: 10rpx;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t.spot-date, .spot-address, .spot-price {\n\t\t\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\t\t\talign-items: center;\n\t\t\t\t\t\t\t\tfont-size: 24rpx;\n\t\t\t\t\t\t\t\tcolor: #666666;\n\t\t\t\t\t\t\t\tmargin-bottom: 10rpx;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\ttext {\n\t\t\t\t\t\t\t\t\tmargin-left: 6rpx;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t.spot-notes {\n\t\t\t\t\t\tbackground-color: #f9f9f9;\n\t\t\t\t\t\tpadding: 20rpx;\n\t\t\t\t\t\tborder-radius: 10rpx;\n\t\t\t\t\t\tfont-size: 26rpx;\n\t\t\t\t\t\t\n\t\t\t\t\t\t.notes-label {\n\t\t\t\t\t\t\tcolor: #999999;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t.notes-content {\n\t\t\t\t\t\t\tcolor: #666666;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t.empty-spots {\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t\tjustify-content: center;\n\t\t\talign-items: center;\n\t\t\tpadding: 50rpx 0;\n\t\t\t\n\t\t\t.empty-image {\n\t\t\t\twidth: 200rpx;\n\t\t\t\theight: 200rpx;\n\t\t\t\tmargin-bottom: 30rpx;\n\t\t\t}\n\t\t\t\n\t\t\ttext {\n\t\t\t\tfont-size: 28rpx;\n\t\t\t\tcolor: #999999;\n\t\t\t\tmargin-bottom: 30rpx;\n\t\t\t}\n\t\t\t\n\t\t\t.add-btn {\n\t\t\t\twidth: 300rpx;\n\t\t\t\theight: 80rpx;\n\t\t\t\tline-height: 80rpx;\n\t\t\t\tborder-radius: 40rpx;\n\t\t\t\tfont-size: 30rpx;\n\t\t\t\tcolor: #ffffff;\n\t\t\t\tbackground-color: #007AFF;\n\t\t\t}\n\t\t}\n\t}\n</style> ","import MiniProgramPage from 'D:/programs2024to2025/ranjiangtaoprogram/first/TravelPlatformMiniProgram/pages/plans/plan-detail.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","uniCloud","res"],"mappings":"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"}