{"version":3,"file":"profile.js","sources":["pages/user/profile.vue","E:/HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdXNlci9wcm9maWxlLnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view class=\"container\">\r\n\t\t<view class=\"profile-list\">\r\n\t\t\t<view class=\"profile-item\" @click=\"goToAvatar\">\r\n\t\t\t\t<text class=\"label\">头像</text>\r\n\t\t\t\t<view class=\"right\">\r\n\t\t\t\t\t<image class=\"avatar\" :src=\"userInfo.avatar\" mode=\"aspectFill\"></image>\r\n\t\t\t\t\t<text class=\"iconfont icon-arrow-right\"></text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<view class=\"profile-item\">\r\n\t\t\t\t<text class=\"label\">用户名</text>\r\n\t\t\t\t<view class=\"right\">\r\n\t\t\t\t\t<input \r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tv-model=\"userInfo.username\"\r\n\t\t\t\t\t\tplaceholder=\"请输入用户名\"\r\n\t\t\t\t\t\t@blur=\"updateField('username')\"\r\n\r\n\t\t\t\t\t/>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<view class=\"profile-item\">\r\n\t\t\t\t<text class=\"label\">性别</text>\r\n\t\t\t\t<view class=\"right\">\r\n\t\t\t\t\t<text>{{userInfo.gender === 1 ? '男' : '女'}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<view class=\"profile-item\" @click=\"goToChangeMobile\">\r\n\t\t\t\t<text class=\"label\">手机号</text>\r\n\t\t\t\t<view class=\"right\">\r\n\t\t\t\t\t<text>{{formatPhone(userInfo.mobile)}}</text>\r\n\t\t\t\t\t<text class=\"iconfont icon-arrow-right\"></text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<view class=\"profile-item\" @click=\"goToChangePassword\">\r\n\t\t\t\t<text class=\"label\">修改密码</text>\r\n\t\t\t\t<view class=\"right\">\r\n\t\t\t\t\t<text class=\"iconfont icon-arrow-right\"></text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n/**\r\n * 个人信息页面\r\n * @description 用户可以查看和修改个人信息\r\n */\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tuserInfo: null\r\n\t\t}\r\n\t},\r\n\tonShow() {\r\n\t\tthis.getUserInfo()\r\n\t},\r\n\tmethods: {\r\n\t\t// 获取用户信息\r\n\t\tgetUserInfo() {\r\n\t\t\tconst userInfo = uni.getStorageSync('userInfo')\r\n\t\t\tif (userInfo) {\r\n\t\t\t\tthis.userInfo = { ...userInfo }\r\n\t\t\t} else {\r\n\t\t\t\tuni.navigateBack()\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// 格式化手机号\r\n\t\tformatPhone(phone) {\r\n\t\t\treturn phone.replace(/(\\d{3})\\d{4}(\\d{4})/, '$1****$2')\r\n\t\t},\r\n\t\t\r\n\t\t// 更新字段\r\n\t\tasync updateField(field) {\r\n\t\t\ttry {\r\n\t\t\t\tconst res = await uniCloud.callFunction({\r\n\t\t\t\t\tname: 'update-user-info',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tuserId: this.userInfo.id,\r\n\t\t\t\t\t\tfield,\r\n\t\t\t\t\t\tvalue: this.userInfo[field]\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tif (res.result.code === 0) {\r\n\t\t\t\t\t// 更新本地存储\r\n\t\t\t\t\tuni.setStorageSync('userInfo', this.userInfo)\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '更新成功',\r\n\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthrow new Error(res.result.message)\r\n\t\t\t\t}\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error('更新失败:', e)\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '更新失败',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// 跳转到头像页\r\n\t\tgoToAvatar() {\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl: '/pages/user/avatar'\r\n\t\t\t})\r\n\t\t},\r\n\t\t\r\n\t\t// 跳转到修改密码页\r\n\t\tgoToChangePassword() {\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl: '/pages/user/change-password'\r\n\t\t\t})\r\n\t\t},\r\n\t\t\r\n\t\t// 跳转到更换手机号页\r\n\t\tgoToChangeMobile() {\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl: '/pages/user/change-mobile'\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.container {\r\n\tmin-height: 100vh;\r\n\tbackground-color: #f5f5f5;\r\n\tpadding: 20rpx;\r\n}\r\n\r\n.profile-list {\r\n\tbackground-color: #fff;\r\n\tborder-radius: 12rpx;\r\n\t\r\n\t.profile-item {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tpadding: 30rpx;\r\n\t\tborder-bottom: 1rpx solid #eee;\r\n\t\t\r\n\t\t&:last-child {\r\n\t\t\tborder-bottom: none;\r\n\t\t}\r\n\t\t\r\n\t\t.label {\r\n\t\t\tfont-size: 28rpx;\r\n\t\t\tcolor: #333;\r\n\t\t}\r\n\t\t\r\n\t\t.right {\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\t\r\n\t\t\t.avatar {\r\n\t\t\t\twidth: 80rpx;\r\n\t\t\t\theight: 80rpx;\r\n\t\t\t\tborder-radius: 40rpx;\r\n\t\t\t\tmargin-right: 20rpx;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tinput {\r\n\t\t\t\ttext-align: right;\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tcolor: #666;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\ttext {\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tcolor: #666;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.icon-arrow-right {\r\n\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\tcolor: #999;\r\n\t\t\t\tmargin-left: 10rpx;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n</style> ","import MiniProgramPage from 'D:/programs2024to2025/ranjiangtaoprogram/first/TravelPlatformMiniProgram/pages/user/profile.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","uniCloud"],"mappings":";;AAsDA,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,UAAU;AAAA,IACX;AAAA,EACA;AAAA,EACD,SAAS;AACR,SAAK,YAAY;AAAA,EACjB;AAAA,EACD,SAAS;AAAA;AAAA,IAER,cAAc;AACb,YAAM,WAAWA,cAAAA,MAAI,eAAe,UAAU;AAC9C,UAAI,UAAU;AACb,aAAK,WAAW,EAAE,GAAG,SAAS;AAAA,aACxB;AACNA,sBAAAA,MAAI,aAAa;AAAA,MAClB;AAAA,IACA;AAAA;AAAA,IAGD,YAAY,OAAO;AAClB,aAAO,MAAM,QAAQ,uBAAuB,UAAU;AAAA,IACtD;AAAA;AAAA,IAGD,MAAM,YAAY,OAAO;AACxB,UAAI;AACH,cAAM,MAAM,MAAMC,cAAQ,GAAC,aAAa;AAAA,UACvC,MAAM;AAAA,UACN,MAAM;AAAA,YACL,QAAQ,KAAK,SAAS;AAAA,YACtB;AAAA,YACA,OAAO,KAAK,SAAS,KAAK;AAAA,UAC3B;AAAA,SACA;AAED,YAAI,IAAI,OAAO,SAAS,GAAG;AAE1BD,wBAAAA,MAAI,eAAe,YAAY,KAAK,QAAQ;AAC5CA,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAO;AAAA,YACP,MAAM;AAAA,WACN;AAAA,eACK;AACN,gBAAM,IAAI,MAAM,IAAI,OAAO,OAAO;AAAA,QACnC;AAAA,MACD,SAAS,GAAG;AACXA,sBAAAA,MAAA,MAAA,SAAA,iCAAc,SAAS,CAAC;AACxBA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,SACN;AAAA,MACF;AAAA,IACA;AAAA;AAAA,IAGD,aAAa;AACZA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA,OACL;AAAA,IACD;AAAA;AAAA,IAGD,qBAAqB;AACpBA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA,OACL;AAAA,IACD;AAAA;AAAA,IAGD,mBAAmB;AAClBA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA,OACL;AAAA,IACF;AAAA,EACD;AACD;;;;;;;;;;;;;;;AClIA,GAAG,WAAW,eAAe;"}